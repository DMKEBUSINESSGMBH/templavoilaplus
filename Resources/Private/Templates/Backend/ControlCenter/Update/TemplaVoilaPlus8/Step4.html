{namespace core=TYPO3\CMS\Core\ViewHelpers}

<div class="callout">
    <h2 class="text-primary">Update configuration to TemplaVoilà! Plus 8</h2>
    <h2>Step 4 - Extension created/updated</h2>

    <form action="#" method="POST">
        <input type="hidden" name="update" value="TemplaVoilaPlus8">
        <input type="hidden" name="selection" value="{selection}">
        <input type="hidden" name="newExtensionKey" value="{newExtensionKey}">

        <input type="hidden" name="vendorName" value="{vendorName}">
        <input type="hidden" name="extensionName" value="{extensionName}">
        <input type="hidden" name="author" value="{author}">
        <input type="hidden" name="authorCompany" value="{authorCompany}">

        <input type="hidden" name="covertingInstructionsJson" value="{covertingInstructionsJson}">
        <input type="hidden" name="extensionAlreadyInstalled" value="{extensionAlreadyInstalled}">

        <f:if condition="{hasError}">
            <f:be.infobox title="Error" state="2">
                <ul class="list-group">
                    <f:for each="{errors}" as="convertError">
                        <li class="list-group-item list-group-item-danger">{convertError}</li>
                    </f:for>
                </ul>
            </f:be.infobox>
        </f:if>

        <f:if condition="{hasWarning}">
            <f:be.infobox title="Warnings" state="1">
                <ul class="list-group">
                    <f:for each="{warnings}" as="convertWarning">
                        <li class="list-group-item list-group-item-warning">{convertWarning}</li>
                    </f:for>
                </ul>
            </f:be.infobox>
        </f:if>

        <f:if condition="{hasError} || {hasWarning}">
            <p><input type="checkbox" name="overwrite" value="true"> Remove data or overwrite on rerun.</p>
        </f:if>

        <f:if condition="!{hasError}">
            <p class="lead">We converted <f:count subject=”{covertingInstructions}" /> Template Objects with their corresponding Data Structures. We also created the default places for configurations and copied/created all files to where they belong, so they can live long and prosper. On the next step we will register your extension and update the pages and tt_content table to point to the newly created MappingConfiguration.</p>
        </f:if>

        <div class="row">
            <div class="col-sm-4">
                <f:link.action action="step3" class="btn btn-default btn-block btn-lg">
                    <core:icon identifier="actions-view-go-back" /> Back to step 3
                </f:link.action>
            </div>
            <div class="col-sm-4">
                <button class="btn {f:if(condition='!{hasError}', then='btn-success', else='btn-primary')} btn-block btn-lg" type="submit">
                    <core:icon identifier="actions-system-refresh" /> Rerun step 4
                </button>
            </div>
            <div class="col-sm-4">
                <f:form.button class="btn btn-primary btn-block btn-lg {f:if(condition='{hasError} || {hasWarning}', then='disabled')}" type="{f:if(condition='{hasError} || {hasWarning}', then='button', else='submit')}" id="continueButton" additionalAttributes="{formaction: '{f:uri.action(controller: \'Backend\\ControlCenter\\Update\\TemplaVoilaPlus8\', action: \'step5\')}'}">
                    <core:icon identifier="actions-view-go-forward" /> Continue with step 5
                </f:form.button>
            </div>
        </div>
    </form>
</div>
